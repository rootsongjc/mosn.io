<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="652" height="333"><source><![CDATA[新MOSN->新MOSN: 开启数据平面
新MOSN->旧MOSN: 通知退出
新MOSN->新MOSN: 监听 conn.sock
旧MOSN->新MOSN: 建立在 conn.sock 上的连接，并转移长连接
旧MOSN->旧MOSN: 等待一段时间后退出
]]></source><desc/><defs><marker id="markerArrowBlock" markerHeight="5" markerWidth="5" orient="auto" refX="5" refY="2.5" viewBox="0 0 5 5"><path d="M 0 0 L 5 2.5 L 0 5 z"/></marker><marker id="markerArrowOpen" markerHeight="16" markerWidth="4" orient="auto" refX="9.6" refY="8" viewBox="0 0 9.6 16"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"/></marker></defs><g class="actor"><rect width="75.906" height="39" x="10" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="21" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">新MOSN</tspan></text></g><g class="actor"><rect width="75.906" height="39" x="10" y="274" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="21" y="299" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">新MOSN</tspan></text></g><line x1="47.953" x2="47.953" y1="59" y2="274" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="74.906" height="39" x="362.469" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="372.469" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="372.469">旧MOSN</tspan></text></g><g class="actor"><rect width="74.906" height="39" x="362.469" y="274" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="372.469" y="299" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="372.469">旧MOSN</tspan></text></g><line x1="399.922" x2="399.922" y1="59" y2="274" fill="none" stroke="#000" style="stroke-width:2"/><g class="signal"><text x="73.953" y="93.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="72.953">开启数据平面</tspan></text><line x1="47.953" x2="67.953" y1="79" y2="79" fill="none" stroke="#000" style="stroke-width:2"/><line x1="67.953" x2="67.953" y1="79" y2="103" fill="none" stroke="#000" style="stroke-width:2"/><line x1="67.953" x2="47.953" y1="103" y2="103" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="192.43" y="128.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="191.43">通知退出</tspan></text><line x1="47.953" x2="399.922" y1="137" y2="137" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="73.953" y="171.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="72.953">监听 conn.sock</tspan></text><line x1="47.953" x2="67.953" y1="157" y2="157" fill="none" stroke="#000" style="stroke-width:2"/><line x1="67.953" x2="67.953" y1="157" y2="181" fill="none" stroke="#000" style="stroke-width:2"/><line x1="67.953" x2="47.953" y1="181" y2="181" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="58.953" y="206.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="57.953">建立在 conn.sock 上的连接，并转移长连接</tspan></text><line x1="399.922" x2="47.953" y1="215" y2="215" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="425.922" y="249.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="424.922">等待一段时间后退出</tspan></text><line x1="399.922" x2="419.922" y1="235" y2="235" fill="none" stroke="#000" style="stroke-width:2"/><line x1="419.922" x2="419.922" y1="235" y2="259" fill="none" stroke="#000" style="stroke-width:2"/><line x1="419.922" x2="399.922" y1="259" y2="259" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g></svg>